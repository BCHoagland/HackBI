<!DOCTYPE html>
<html>
<head>
	<title>HackBI Registration</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="style.css">
	<style>
body {
	font-family: Montserrat, Metrophobic;
	color: #333;
}

a, a h3 {
	color: inherit;
}

#thankyou_message {
	text-align: center;
	margin: 10rem;
	display: none;
}
#thankyou_message h1 {
	margin-bottom: 4rem;
}

.jumbotron {
	color: #fff;
	font: 4em Jaapokki;
	background: repeating-linear-gradient(
  	45deg,
  	var(--bg-light),
  	var(--bg-light) 80px,
  	var(--bg-dark) 80px,
  	var(--bg-dark) 160px
	);
	background-size: cover;
}

#steps {
	margin-bottom: 2rem;
}

#steps h2 {
	font-weight: bold;
}

#steps a {
	color: #999;
}

#steps a:hover, #steps a h3:hover {
	color: #999;
}

a:hover {
	color: inherit;
}

#steps .col {
	padding: 2rem;
}

#confirmation-info {
	color: #fff;
	background: repeating-linear-gradient(
  	-45deg,
  	var(--bg-light),
  	var(--bg-light) 80px,
  	var(--bg-dark) 80px,
  	var(--bg-dark) 160px
	);
	background-size: cover;
	padding: 4rem;
	margin-top: 4rem;
}

#confirmation-info h3 {
	font-weight: bold;
}

#confirmation-info a {
	font-size: 1.4rem;
	text-decoration: none;
}

/*#days {
	margin-top: 2rem;
	margin-bottom: 2rem;
}*/
.form-check {
	text-align: left;
}
label, .form-check-label {
	font-weight: normal;
}

.checkbox {
	margin: 3rem 0 3rem 0;
}

.btn {
	font-size: 2rem;
	color: #fff;
	background-color: var(--bg-light);
	border-color: var(--bg-light);
}
.btn:hover {
	background-color: var(--bg-dark);
	border-color: var(--bg-dark);
}

.colWithBorder {
	border-right: 2px solid var(--complement-color);
}

.form-group {
	margin: 0;
}

.grade, .middle-school, .high-school {
	margin-bottom: 2rem;
	display: none;
}

.programming-experience, .t-shirt-size {
	margin-top: 2rem;
}

.select-buttons label {
	font-size: 1rem;
	color: inherit;
	background-color: #fff;
	border-color: inherit;
	margin: 1rem 0 2rem 0;
}

.select-buttons label:hover {
	background-color: #fff;
	border-color: inherit;
}

.schools-group {
	border-top: 1px solid var(--complement-color);
	border-bottom: 1px solid var(--complement-color);
	padding-top: 1rem;
	margin: 1rem 0 2rem 0;
}

#submission-controls button {
	font-size: 1.4rem;
}
    </style>
</head>
<body>
	<div class="jumbotron text-center"><br/>Register for HackBI<br/><br/></div>

	<div class="row text-center" id="steps">
		<div class="col-sm-6 colWithBorder col">
			<h2>Step 1:</h2>
			<h3>Download the following two files, fill them, out and scan them to <a href="mailto:hackbi@bishopireton.org">hackbi@bishopireton.org</a></h3><br/>
			<a href="files/emergencyCarePermission.doc">
				<h3>Emergency Care Permission Form</h3>
			</a><br/>
			<a href="files/parentPermission.pdf">
				<h3>Parent Permission Form</h3>
			</a>
		</div>
		<div class="col-sm-6 col">
			<h2>Step 2:</h2>
			<h3>Fill out the following form and you're all set!</h3>
		</div>
	</div>

	<div id="thankyou_message">
		<h1>Thank you for signing up for HackBI!</h1>
		<h4>You should receive an email shortly. If you do not receive one within a few minutes, email us as <a href="mailto:hackbi@bishopireton.org">hackbi@bishopireton.org</a> and we'll make sure you're signed up</h3>
	</div>

	<div class="col-sm-6 offset-sm-3">
	<form id="gform" method="POST" action="https://script.google.com/a/bishopireton.org/macros/s/AKfycbySc9-oNaIhd4fehpybN3XEkl1dK_T05FB-ywpuYyeiNMOpTYuc/exec">
		<div class="form-group">
			<label for="first-name">First Name*</label>
			<input name="first-name" type="text" class="form-control" placeholder="First Name" oninvalid="this.setCustomValidity('We need to know your name')" oninput="setCustomValidity('')" required><br/>

			<label for="last-name">Last Name*</label>
			<input name="last-name" type="text" class="form-control" placeholder="Last Name" oninvalid="this.setCustomValidity('We need to know your name')" oninput="setCustomValidity('')" required><br/>
		</div>

		<div class="form-group">
			<label for="email">Email*</label>
			<input name="email" type="email" class="form-control" placeholder="Email" oninvalid="this.setCustomValidity('We need your email to update you about HackBI')" oninput="setCustomValidity('')" required><br/>
		</div>

		<div class="schools-group">

			<div class="btn-group select-buttons" data-toggle="buttons">
				<label class="btn btn-secondary" id="middle-school-option">
					<input type="radio" autocomplete="off">Middle School
				</label>
				<label class="btn btn-secondary" id="high-school-option">
					<input type="radio" autocomplete="off">High School
				</label>
			</div>

			<div class="form-group middle-school">
				<label for="middle-school">Middle School</label>
				<select class="form-control" name="middle-school" id="middle-school">
					<option disabled selected value></option>
				</select>
			</div>

			<div class="form-group high-school">
				<label for="high-school">High School</label>
				<select class="form-control" name="high-school" id="high-school">
					<option disabled selected value></option>
					<option>None</option>
					<option>Academy of the Holy Cross</option>
					<option>Archbishop Carroll High School</option>
					<option>Ballou</option>
					<option>Benedictine High School</option>
					<option>Bethesda, Chevy Chase</option>
					<option>Bishop Denis J. O'Connell High School</option>
					<option>Bishop Ireton High School</option>
					<option>Bishop McNamara High School</option>
					<option>Bishop Sullivan</option>
					<option>Blue Ridge School</option>
					<option>Brentsville</option>
					<option>Broad Run</option>
					<option>Bullis School</option>
					<option>Caesar Chavez Public Charter School</option>
					<option>Centreville</option>
					<option>Chantilly</option>
					<option>Chopticon</option>
					<option>Collegiate School</option>
					<option>Colonial Forge</option>
					<option>Concordia Preparatory School</option>
					<option>Connelly School of the Holy Child</option>
					<option>DeMatha Catholic High School</option>
					<option>Dominion/Potomac Falls</option>
					<option>Eleanor Roosevelt</option>
					<option>Elizabeth Seton High School</option>
					<option>Episcopal</option>
					<option>Fishburne Military School</option>
					<option>Flint Hill School</option>
					<option>Fredericksburg Christian Academy</option>
					<option>Georgetown Day School</option>
					<option>Georgetown Preparatory School for Boys</option>
					<option>Georgetown Visitation School</option>
					<option>Glenelg Country Day School</option>
					<option>Gonzaga College High School</option>
					<option>Hayfield</option>
					<option>Highland School</option>
					<option>JEB Stuart</option>
					<option>James Madison</option>
					<option>Kettle Run</option>
					<option>King Abdullah Academy</option>
					<option>Lake Braddock</option>
					<option>Landon School</option>
					<option>Langley</option>
					<option>Leonardtown</option>
					<option>Madeira School</option>
					<option>Maret School</option>
					<option>Maryland School for the Deaf</option>
					<option>Model Secondary School for the Deaf</option>
					<option>Mount Vernon</option>
					<option>National Cathedral School</option>
					<option>National Christian Academy</option>
					<option>Norfolk Academy</option>
					<option>Norfolk Christian Academy</option>
					<option>Oakcrest School</option>
					<option>Oakton</option>
					<option>Our Lady of Good Counsel</option>
					<option>Paint Branch</option>
					<option>Patriot</option>
					<option>Paul VI Catholic High School</option>
					<option>Peninsula Catholic High School</option>
					<option>Randolph Macon Academy</option>
					<option>Riverdale Baptist School</option>
					<option>Robinson</option>
					<option>School without Walls</option>
					<option>Severn School</option>
					<option>Sherando</option>
					<option>Sidwell Friends School</option>
					<option>Springbrook</option>
					<option>St Albans School for Boys</option>
					<option>St Andrew's Episcopal</option>
					<option>St Anne's Bellfield School</option>
					<option>St Anselm's Abbey School</option>
					<option>St Catherine's School</option>
					<option>St Christopher's School</option>
					<option>St Gertrude's High School</option>
					<option>St James School</option>
					<option>St John Paul the Great High School</option>
					<option>St John's College High School</option>
					<option>St Mary's Ryken High School</option>
					<option>St Mary's of Annapolis</option>
					<option>St Michael's School</option>
					<option>St Paul's School for Girls</option>
					<option>St Stephens &amp; St Agnes School</option>
					<option>Stone Bridge</option>
					<option>Stone Ridge School of the Sacred Heart</option>
					<option>Stonewall Jackson</option>
					<option>TC Williams</option>
					<option>The Heights School</option>
					<option>The Miller School of Albemarle</option>
					<option>The Potomac School</option>
					<option>Thomas Edison</option>
					<option>Thomas Jefferson</option>
					<option>Trinity Christian School</option>
					<option>Trinity Episcopal School</option>
					<option>WT Woodson</option>
					<option>Wakefield School</option>
					<option>Walter Johnson</option>
					<option>Washington International School</option>
					<option>West Potomac</option>
					<option>West Springfield</option>
					<option>Westfield</option>
					<option>Westfield</option>
					<option>Woodberry Forest School</option>
					<option>Woodbridge</option>
					<option>Woodrow Wilson</option>
					<option>Yorktown HS</option>
				</select>
			</div>

			<div class="form-group grade">
				<label for="grade">Grade</label>
				<select class="form-control" name="grade" id="grade">
					<option disabled selected value></option>
					<option>9</option>
					<option>10</option>
					<option>11</option>
					<option>12</option>
				</select>
			</div>

		</div>

		<div class="form-group">
			<label for="food-allergies">Please list any food allergies here</label>
			<input name="food-allergies" type="text" class="form-control" placeholder="Food Alergies">
		</div>

		<div class="form-group programming-experience">
			<label for="programming-experience">Programming Experience</label>
			<select class="form-control" name="programming-experience" id="programming-experience">
				<option disabled selected value></option>
				<option>None</option>
				<option>Less than 1 year</option>
				<option>1 year</option>
				<option>2 years</option>
				<option>3 years</option>
				<option>4+ years</option>
			</select>
		</div>

		<div class="form-group t-shirt-size">
			<label for="t-shirt-size">T-shirt Size*</label>
			<select class="form-control" name="t-shirt-size" id="t-shirt-size" required>
				<option disabled selected value></option>
				<option>YL</option>
				<option>S</option>
				<option>M</option>
				<option>L</option>
				<option>XL</option>
			</select>
		</div>

		<div class="form-check">
			<div class="col-sm-6 offset-sm-3">
				<div class="checkbox">
					<label class="custom-control custom-checkbox">
						<input type="checkbox" class="custom-control-input" required>
						<span class="custom-control-indicator"></span>
						<span class="custom-control-description">I agree to the terms of both the MLH Contest Terms and Conditions and the MLH Privacy Policy. Please note that you may receive pre and post-event informational e-mails and occasional messages about hackathons from MLH as per the MLH Privacy Policy.</span>
					</label>
				</div>
			</div>
		</div>

		<div class="form-group text-center" id="submission-controls">
			<div class="col-sm-6 offset-sm-3">
				<button type="submit" class="btn btn-primary">Submit</button>
				<button type="reset" class="btn btn-primary">Reset</button>
			</div>
		</div>
	</form>
</div>

</div class="row">
	<div class="col-sm-12 text-center" id="confirmation-info">
		<h3>Done here?</h3>
		<a href="index.html" class="make-translucent">Click here to head back to the main HackBI page</a><br/>
	</div>
</div>
<script>
function validEmail(email) { // see:
  var re = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
  return re.test(email);
}

function validateHuman(honeypot) {
  if (honeypot) {  //if hidden form filled up
    console.log("Robot Detected!");
    return true;
  } else {
    console.log("Welcome Human!");
  }
}

// get all data in form and return object
function getFormData() {
  var elements = document.getElementById("gform").elements; // all form elements
  var fields = Object.keys(elements).map(function(k) {
    if(elements[k].name !== undefined) {
      return elements[k].name;
    // special case for Edge's html collection
    }else if(elements[k].length > 0){
      return elements[k].item(0).name;
    }
  }).filter(function(item, pos, self) {
    return self.indexOf(item) == pos && item;
  });
  var data = {};
  fields.forEach(function(k){
    data[k] = elements[k].value;
    var str = ""; // declare empty string outside of loop to allow
                  // it to be appended to for each item in the loop
    if(elements[k].type === "checkbox"){ // special case for Edge's html collection
      str = str + elements[k].checked + ", "; // take the string and append
                                              // the current checked value to
                                              // the end of it, along with
                                              // a comma and a space
      data[k] = str.slice(0, -2); // remove the last comma and space
                                  // from the  string to make the output
                                  // prettier in the spreadsheet
    }else if(elements[k].length){
      for(var i = 0; i < elements[k].length; i++){
        if(elements[k].item(i).checked){
          str = str + elements[k].item(i).value + ", "; // same as above
          data[k] = str.slice(0, -2);
        }
      }
    }
  });
  console.log(data);
  return data;
}

function handleFormSubmit(event) {  // handles form submit withtout any jquery
  event.preventDefault();           // we are submitting via xhr below
  var data = getFormData();         // get the values submitted in the form

  /* OPTION: Remove this comment to enable SPAM prevention, see README.md
  if (validateHuman(data.honeypot)) {  //if form is filled, form will not be submitted
    return false;
  }
  */

  if( !validEmail(data.email) ) {   // if email is not valid show error
    document.getElementById('email-invalid').style.display = 'block';
    return false;
  } else {

		document.getElementById('submission-controls').style.display = 'none';

    var url = event.target.action;  //
    var xhr = new XMLHttpRequest();
    xhr.open('POST', url);
    // xhr.withCredentials = true;
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.onreadystatechange = function() {
        console.log( xhr.status, xhr.statusText )
        console.log(xhr.responseText);
        document.getElementById('gform').style.display = 'none'; // hide form
        document.getElementById('thankyou_message').style.display = 'block';
        return;
    };
    // url encode form data for sending as post data
    var encoded = Object.keys(data).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(data[k])
    }).join('&')
    xhr.send(encoded);
  }
}

function loaded() {
  console.log('contact form submission handler loaded successfully');
  // bind to the submit event of our form
  var form = document.getElementById('gform');
  form.addEventListener("submit", handleFormSubmit, false);
};
document.addEventListener('DOMContentLoaded', loaded, false);

function setGrades(options) {
	$('#grade option:gt(0)').remove();
	var $el = $("#grade");
	$.each(options, function(key,value) {
		$el.append($("<option></option>").attr("value", value).text(key));
	});
}

$(document).ready(function() {
	$('#middle-school-option').click(function() {
		var newOptions = {"6": "6", "7": "7", "8": "8"};
		setGrades(newOptions);
		$('.grade').css('display', 'inherit');
		$('.middle-school').css('display', 'inherit');
		$('.high-school').css('display', 'none');
	});

	$('#high-school-option').click(function() {
		var newOptions = {"9": "9", "10": "10", "11": "11", "12": "12"};
		setGrades(newOptions);
		$('.grade').css('display', 'inherit');
		$('.high-school').css('display', 'inherit');
		$('.middle-school').css('display', 'none');
	});
});
</script>
</html>
